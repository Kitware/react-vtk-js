import{r as d,a as T,j as ae}from"./index.a0b359a0.js";import{g as B,i as Le,_ as Ne,j as oe,k as Re,o as ye,q as Ue,r as Ie,t as je,x as We,y as Ge,V as _e,e as Te,z as $e,v as Ke,s as He,A as ie,L as Pe}from"./light.105d5280.js";var xe=B.vtkErrorMacro;function Je(e,t){t.classHierarchy.push("vtkCollection"),e.addItem=function(n){t.collection.push(n),e.modified()},e.insertItem=function(n,r){(n<0||t.collection.length<n)&&xe("idx out of bounds for insertion."),t.collection.splice(n,0,r),e.modified()},e.replaceItem=function(n,r){t.collection.splice(n,1,r),e.modified()},e.removeItem=function(n){var r=typeof n=="number"?n:t.collection.indexOf(n);r>=0&&r<t.collection.length?(t.collection.splice(r,1),e.modified()):xe("idx out of bounds for removeItem.")},e.removeAllItems=function(){t.collection=[],e.modified()},e.isItemPresent=function(n){return t.collection.includes(n)},e.getNumberOfItems=function(){return t.collection.length},e.empty=function(){return t.collection.length===0},e.getItem=function(n){return t.collection[n]},e.forEach=function(n){t.collection.forEach(n),e.updateMTimeWithElements()},e.reduce=function(n,r){return t.collection.reduce(n,r)},e.map=function(n){return t.collection.map(n)},e.updateMTimeWithElements=function(){for(var n=0,r=0;r<t.collection.length;++r){var s=t.collection[r];n=Math.max(n,s.getMTime())}n>e.getMTime()&&e.modified()}}var Ye={collection:[]};function Ce(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,Ye,n),B.obj(e,t),Je(e,t)}var qe=B.newInstance(Ce,"vtkCollection"),Qe={newInstance:qe,extend:Ce};function Se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Se(Object(n),!0).forEach(function(r){Ne(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Se(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var Xe=oe.staticOffsetAPI,Ze=oe.otherStaticMethods,et=B.vtkErrorMacro,Y=B.vtkWarningMacro,tt=Le.SlicingMode;function nt(e,t){t.classHierarchy.push("vtkImageArrayMapper");var n=function(){var a=e.getInputData();if(!a||a.empty()){t.sliceToSubSliceMap.length!==0&&(t.sliceToSubSliceMap.length=0,e.modified());return}if(t.sliceToSubSliceMap.length===0||a.getMTime()>e.getMTime()){var i=a.map(function(l,c){for(var u=l.getDimensions(),v=new Array(u[t.slicingMode]),g=0;g<v.length;++g)v[g]={imageIndex:c,subSlice:g};return v});t.sliceToSubSliceMap=i.flat(),e.modified()}},r=e.setInputData,s=e.setInputConnection;e.setInputData=function(o){r(o),n()},e.setInputConnection=function(o){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;s(o,a),n()},e.getImage=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.getSlice(),a=e.getInputData();if(!a)Y("No input set.");else if(o<0||o>=e.getTotalSlices())Y("Invalid slice number.");else return n(),a.getItem(t.sliceToSubSliceMap[o].imageIndex);return null},e.getBounds=function(){var o=e.getCurrentImage();if(!o)return ye();if(!t.useCustomExtents)return o.getBounds();var a=t.customDisplayExtent.slice(),i=e.getSubSlice();return a[4]=i,a[5]=i,o.extentToBounds(a)},e.getBoundsForSlice=function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.getSlice(),a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=e.getImage(o);if(!i)return ye();var l=i.getSpatialExtent(),c=e.getSubSlice(o);return l[4]=c-a,l[5]=c+a,i.extentToBounds(l)},e.getClosestIJKAxis=function(){return{ijkMode:t.slicingMode,flip:!1}},e.computeTotalSlices=function(){for(var o=e.getInputData(),a=o.getNumberOfItems(),i=0,l=0;l<a;++l){var c=o.getItem(l);c&&(i+=c.getDimensions()[t.slicingMode])}return i},e.getTotalSlices=function(){return n(),t.sliceToSubSliceMap.length},e.setSlice=function(o){var a=e.getInputData();if(!a){Y("No input set.");return}var i=e.getTotalSlices();o>=0&&o<i?(t.slice=o,e.modified()):et("Slice number out of range. Acceptable range is: [0, ".concat(i>0?i-1:0,"]slice <= totalSlices"))},e.computeSlice=function(o,a){return n(),t.sliceToSubSliceMap.findIndex(function(i){return i.imageIndex===o&&i.subSlice===a})},e.getImageIndex=function(){var o,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.getSlice();return n(),(o=t.sliceToSubSliceMap[a])===null||o===void 0?void 0:o.imageIndex},e.getSubSlice=function(){var o,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e.getSlice();return n(),(o=t.sliceToSubSliceMap[a])===null||o===void 0?void 0:o.subSlice},e.getCurrentImage=function(){return e.getImage(e.getSlice())},e.intersectWithLineForPointPicking=function(o,a){return Ue(o,a,e)},e.intersectWithLineForCellPicking=function(o,a){return Ie(o,a,e)}}var rt={slicingMode:tt.K,sliceToSubSliceMap:[]};function ke(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.assign(t,rt,n),Re.extend(e,t,n),B.get(e,t,["slicingMode"]),oe.implementCoincidentTopologyMethods(e,t),nt(e,t)}var at=B.newInstance(ke,"vtkImageArrayMapper"),ot=de(de({newInstance:at,extend:ke},Xe),Ze),j=[];function it(e){return new Promise(function(t,n){if(j.indexOf(e)===-1){j.push(e);var r=document.createElement("script");r.type="text/javascript",r.src=e,r.onload=t,r.onerror=n,document.body.appendChild(r)}else t(!1)})}function st(e){return new Promise(function(t,n){if(j.indexOf(e)===-1){j.push(e);var r=document.createElement("link");r.rel="stylesheet",r.href=e,r.onload=t,r.onerror=n,document.head.appendChild(r)}else t(!1)})}var lt={loadScript:it,loadCSS:st,LOADED_URLS:j},x=Uint8Array,z=Uint16Array,De=Uint32Array,we=new x([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),be=new x([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ct=new x([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ve=function(e,t){for(var n=new z(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];for(var s=new De(n[30]),r=1;r<30;++r)for(var o=n[r];o<n[r+1];++o)s[o]=o-n[r]<<5|r;return[n,s]},Me=Ve(we,2),Oe=Me[0],ft=Me[1];Oe[28]=258,ft[258]=28;var ut=Ve(be,0),pt=ut[0],ee=new z(32768);for(var p=0;p<32768;++p){var M=(p&43690)>>>1|(p&21845)<<1;M=(M&52428)>>>2|(M&13107)<<2,M=(M&61680)>>>4|(M&3855)<<4,ee[p]=((M&65280)>>>8|(M&255)<<8)>>>1}var I=function(e,t,n){for(var r=e.length,s=0,o=new z(t);s<r;++s)e[s]&&++o[e[s]-1];var a=new z(t);for(s=0;s<t;++s)a[s]=a[s-1]+o[s-1]<<1;var i;if(n){i=new z(1<<t);var l=15-t;for(s=0;s<r;++s)if(e[s])for(var c=s<<4|e[s],u=t-e[s],v=a[e[s]-1]++<<u,g=v|(1<<u)-1;v<=g;++v)i[ee[v]>>>l]=c}else for(i=new z(r),s=0;s<r;++s)e[s]&&(i[s]=ee[a[e[s]-1]++]>>>15-e[s]);return i},W=new x(288);for(var p=0;p<144;++p)W[p]=8;for(var p=144;p<256;++p)W[p]=9;for(var p=256;p<280;++p)W[p]=7;for(var p=280;p<288;++p)W[p]=8;var Be=new x(32);for(var p=0;p<32;++p)Be[p]=5;var vt=I(W,9,1),gt=I(Be,5,1),q=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},C=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(t&7)&n},Q=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(t&7)},mt=function(e){return(e+7)/8|0},se=function(e,t,n){(t==null||t<0)&&(t=0),(n==null||n>e.length)&&(n=e.length);var r=new(e.BYTES_PER_ELEMENT==2?z:e.BYTES_PER_ELEMENT==4?De:x)(n-t);return r.set(e.subarray(t,n)),r},yt=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],k=function(e,t,n){var r=new Error(t||yt[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,k),!n)throw r;return r},Tt=function(e,t,n){var r=e.length;if(!r||n&&n.f&&!n.l)return t||new x(0);var s=!t||n,o=!n||n.i;n||(n={}),t||(t=new x(r*3));var a=function(ve){var ge=t.length;if(ve>ge){var me=new x(Math.max(ge*2,ve));me.set(t),t=me}},i=n.f||0,l=n.p||0,c=n.b||0,u=n.l,v=n.d,g=n.m,h=n.n,b=r*8;do{if(!u){i=C(e,l,1);var F=C(e,l+1,3);if(l+=3,F)if(F==1)u=vt,v=gt,g=9,h=5;else if(F==2){var A=C(e,l,31)+257,G=C(e,l+10,15)+4,_=A+C(e,l+5,31)+1;l+=14;for(var R=new x(_),K=new x(19),S=0;S<G;++S)K[ct[S]]=C(e,l+S*3,7);l+=G*3;for(var le=q(K),Fe=(1<<le)-1,ze=I(K,le,1),S=0;S<_;){var ce=ze[C(e,l,Fe)];l+=ce&15;var m=ce>>>4;if(m<16)R[S++]=m;else{var L=0,$=0;for(m==16?($=3+C(e,l,3),l+=2,L=R[S-1]):m==17?($=3+C(e,l,7),l+=3):m==18&&($=11+C(e,l,127),l+=7);$--;)R[S++]=L}}var fe=R.subarray(0,A),V=R.subarray(A);g=q(fe),h=q(V),u=I(fe,g,1),v=I(V,h,1)}else k(1);else{var m=mt(l)+4,y=e[m-4]|e[m-3]<<8,E=m+y;if(E>r){o&&k(0);break}s&&a(c+y),t.set(e.subarray(m,E),c),n.b=c+=y,n.p=l=E*8,n.f=i;continue}if(l>b){o&&k(0);break}}s&&a(c+131072);for(var Ee=(1<<g)-1,Ae=(1<<h)-1,H=l;;H=l){var L=u[Q(e,l)&Ee],N=L>>>4;if(l+=L&15,l>b){o&&k(0);break}if(L||k(2),N<256)t[c++]=N;else if(N==256){H=l,u=null;break}else{var ue=N-254;if(N>264){var S=N-257,U=we[S];ue=C(e,l,(1<<U)-1)+Oe[S],l+=U}var P=v[Q(e,l)&Ae],J=P>>>4;P||k(3),l+=P&15;var V=pt[J];if(J>3){var U=be[J];V+=Q(e,l)&(1<<U)-1,l+=U}if(l>b){o&&k(0);break}s&&a(c+131072);for(var pe=c+ue;c<pe;c+=4)t[c]=t[c-V],t[c+1]=t[c+1-V],t[c+2]=t[c+2-V],t[c+3]=t[c+3-V];c=pe}}n.l=u,n.p=H,n.b=c,n.f=i,u&&(i=1,n.m=g,n.d=v,n.n=h)}while(!i);return c==t.length?t:se(t,0,c)},xt=new x(0),w=function(e,t){return e[t]|e[t+1]<<8},D=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0},X=function(e,t){return D(e,t)+D(e,t+4)*4294967296};function St(e,t){return Tt(e,t)}var te=typeof TextDecoder!="undefined"&&new TextDecoder,dt=0;try{te.decode(xt,{stream:!0}),dt=1}catch{}var ht=function(e){for(var t="",n=0;;){var r=e[n++],s=(r>127)+(r>223)+(r>239);if(n+s>e.length)return[t,se(e,n-1)];s?s==3?(r=((r&15)<<18|(e[n++]&63)<<12|(e[n++]&63)<<6|e[n++]&63)-65536,t+=String.fromCharCode(55296|r>>10,56320|r&1023)):s&1?t+=String.fromCharCode((r&31)<<6|e[n++]&63):t+=String.fromCharCode((r&15)<<12|(e[n++]&63)<<6|e[n++]&63):t+=String.fromCharCode(r)}};function Ct(e,t){if(t){for(var n="",r=0;r<e.length;r+=16384)n+=String.fromCharCode.apply(null,e.subarray(r,r+16384));return n}else{if(te)return te.decode(e);var s=ht(e),o=s[0],a=s[1];return a.length&&k(8),o}}var kt=function(e,t){return t+30+w(e,t+26)+w(e,t+28)},Dt=function(e,t,n){var r=w(e,t+28),s=Ct(e.subarray(t+46,t+46+r),!(w(e,t+8)&2048)),o=t+46+r,a=D(e,t+20),i=n&&a==4294967295?wt(e,o):[a,D(e,t+24),D(e,t+42)],l=i[0],c=i[1],u=i[2];return[w(e,t+10),l,c,s,o+w(e,t+30)+w(e,t+32),u]},wt=function(e,t){for(;w(e,t)!=1;t+=4+w(e,t+2));return[X(e,t+12),X(e,t+4),X(e,t+20)]};function bt(e,t){for(var n={},r=e.length-22;D(e,r)!=101010256;--r)(!r||e.length-r>65558)&&k(13);var s=w(e,r+8);if(!s)return{};var o=D(e,r+16),a=o==4294967295||s==65535;if(a){var i=D(e,r-12);a=D(e,i)==101075792,a&&(s=D(e,i+32),o=D(e,i+48))}for(var l=t&&t.filter,c=0;c<s;++c){var u=Dt(e,o,a),v=u[0],g=u[1],h=u[2],b=u[3],F=u[4],m=u[5],y=kt(e,m);o=F,(!l||l({name:b,size:g,originalSize:h,compression:v}))&&(v?v==8?n[b]=St(e.subarray(y,y+g),new x(h)):k(14,"unknown compression type "+v):n[b]=se(e,y,y+g))}return n}var ne=B.vtkErrorMacro,Vt={Unknown:0,Scalar:1,RGB:2,RGBA:3,Offset:4,Vector:5,Point:6,CovariantVector:7,SymmetricSecondRankTensor:8,DiffusionTensor3D:9,Complex:10,FixedArray:11,Array:12,Matrix:13,VariableLengthVector:14,VariableSizeMatrix:15},f={Unknown:"Unknown",Scalar:"Scalar",RGB:"RGB",RGBA:"RGBA",Offset:"Offset",Vector:"Vector",Point:"Point",CovariantVector:"CovariantVector",SymmetricSecondRankTensor:"SymmetricSecondRankTensor",DiffusionTensor3D:"DiffusionTensor3D",Complex:"Complex",FixedArray:"FixedArray",Array:"Array",Matrix:"Matrix",VariableLengthVector:"VariableLengthVector",VariableSizeMatrix:"VariableSizeMatrix"},re=new Map([["Uint8Array","uint8"],["Int8Array","int8"],["Uint16Array","uint16"],["Int16Array","int16"],["Uint32Array","uint32"],["Int32Array","int32"],["Float32Array","float32"],["Float64Array","float64"]]),he=new Map([["uint8","Uint8Array"],["int8","Int8Array"],["uint16","Uint16Array"],["int16","Int16Array"],["uint32","Uint32Array"],["int32","Int32Array"],["float32","Float32Array"],["float64","Float64Array"]]);function Mt(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n={origin:[0,0,0],spacing:[1,1,1]},r=[1,1,1],s=[1,0,0,0,1,0,0,0,1],o=e.direction.data===void 0,a=o?f:Vt,i=0;i<e.imageType.dimension;++i){n.origin[i]=e.origin[i],n.spacing[i]=e.spacing[i],r[i]=e.size[i];for(var l=0;l<e.imageType.dimension;++l)o?s[l+i*3]=e.direction[i+l*e.imageType.dimension]:s[l+i*3]=e.direction.data[i+l*e.imageType.dimension]}var c=je.newInstance(n),u=We.newInstance({name:t.scalarArrayName||"Scalars",values:e.data,numberOfComponents:e.imageType.components});switch(c.setDirection(s),c.setDimensions.apply(c,r),c.getPointData().setScalars(u),o?a[e.imageType.pixelType]:e.imageType.pixelType){case a.Scalar:break;case a.RGB:break;case a.RGBA:break;case a.Offset:break;case a.Vector:e.imageType.dimension===3&&e.imageType.components===3&&c.getPointData().setVectors(u);break;case a.Point:break;case a.CovariantVector:e.imageType.dimension===3&&e.imageType.components===3&&c.getPointData().setVectors(u);break;case a.SymmetricSecondRankTensor:e.imageType.dimension===3&&e.imageType.components===6&&c.getPointData().setTensors(u);break;case a.DiffusionTensor3D:e.imageType.dimension===3&&e.imageType.components===6&&c.getPointData().setTensors(u);break;case a.Complex:break;case a.FixedArray:break;case a.Array:break;case a.Matrix:break;case a.VariableLengthVector:break;case a.VariableSizeMatrix:break;default:return ne("Cannot handle unexpected itk-wasm pixel type ".concat(e.imageType.pixelType)),null}return c}function Ot(e){for(var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=3,r={imageType:{dimension:n,pixelType:f.Scalar,componentType:"",components:1},name:"vtkImageData",origin:e.getOrigin(),spacing:e.getSpacing(),direction:new Float64Array(9),size:e.getDimensions()},s=e.getDirection(),o=0;o<n;++o)for(var a=0;a<n;++a)r.direction[o+a*n]=s[a+o*n];var i=e.getPointData(),l;return i.getTensors()!==null?(r.imageType.pixelType=f.DiffusionTensor3D,l=i.getTensors()):i.getVectors()!=null?(r.imageType.pixelType=f.Vector,l=i.getVectors()):l=i.getScalars(),r.imageType.componentType=re.get(l.getDataType()),t?r.data=l.getData().slice(0):r.data=l.getData(),r}function Bt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=[];e.pointData.length&&n.push({data:{vtkClass:"vtkDataArray",name:t.pointDataName||"PointData",numberOfComponents:e.polyDataType.pointPixelComponents,size:e.pointData.length,dataType:he.get(e.polyDataType.pointPixelComponentType),buffer:e.pointData.buffer,values:e.pointData}});var r=[];e.cellData.length&&r.push({data:{vtkClass:"vtkDataArray",name:t.cellDataName||"CellData",numberOfComponents:e.polyDataType.pointPixelComponents,size:e.cellData.length,dataType:he.get(e.polyDataType.pointPixelComponentType),buffer:e.cellData.buffer,values:e.cellData}});var s={points:{vtkClass:"vtkPoints",name:"_points",numberOfComponents:3,size:e.numberOfPoints,dataType:"Float32Array",buffer:e.points.buffer,values:e.points},verts:{vtkClass:"vtkCellArray",name:"_verts",numberOfComponents:1,size:e.verticesBufferSize,dataType:"Uint32Array",buffer:e.vertices.buffer,values:e.vertices},lines:{vtkClass:"vtkCellArray",name:"_lines",numberOfComponents:1,size:e.linesBufferSize,dataType:"Uint32Array",buffer:e.lines.buffer,values:e.lines},polys:{vtkClass:"vtkCellArray",name:"_polys",numberOfComponents:1,size:e.polygonsBufferSize,dataType:"Uint32Array",buffer:e.polygons.buffer,values:e.polygons},strips:{vtkClass:"vtkCellArray",name:"_strips",numberOfComponents:1,size:e.triangleStripsBufferSize,dataType:"Uint32Array",buffer:e.triangleStrips.buffer,values:e.triangleStrips},pointData:{vtkClass:"vtkDataSetAttributes",activeGlobalIds:-1,activeNormals:-1,activePedigreeIds:-1,activeScalars:-1,activeTCoords:-1,activeTensors:-1,activeVectors:-1,copyFieldFlags:[],doCopyAllOff:!1,doCopyAllOn:!0,arrays:n},cellData:{vtkClass:"vtkDataSetAttributes",activeGlobalIds:-1,activeNormals:-1,activePedigreeIds:-1,activeScalars:-1,activeTCoords:-1,activeTensors:-1,activeVectors:-1,copyFieldFlags:[],doCopyAllOff:!1,doCopyAllOn:!0,arrays:r}},o=Ge.newInstance(s),a=o.getPointData(),i=o.getCellData();if(e.pointData.length)switch(f[e.polyDataType.pointPixelType]){case f.Scalar:a.setScalars(a.getArrayByIndex(0));break;case f.RGB:break;case f.RGBA:break;case f.Offset:break;case f.Vector:e.polyDataType.pointPixelComponents===3&&a.setVectors(a.getArrayByIndex(0));break;case f.Point:break;case f.CovariantVector:e.polyDataType.pointPixelComponents===3&&a.setVectors(a.getArrayByIndex(0));break;case f.SymmetricSecondRankTensor:e.polyDataType.pointPixelComponents===6&&a.setTensors(a.getArrayByIndex(0));break;case f.DiffusionTensor3D:e.polyDataType.pointPixelComponents===6&&a.setTensors(a.getArrayByIndex(0));break;case f.Complex:break;case f.FixedArray:break;case f.Array:break;case f.Matrix:break;case f.VariableLengthVector:break;case f.VariableSizeMatrix:break;default:return ne("Cannot handle unexpected itk-wasm pixel type ".concat(e.polyDataType.pointPixelType)),null}if(e.cellData.length)switch(f[e.polyDataType.cellPixelType]){case f.Scalar:i.setScalars(i.getArrayByIndex(0));break;case f.RGB:break;case f.RGBA:break;case f.Offset:break;case f.Vector:e.polyDataType.pointPixelComponents===3&&i.setVectors(i.getArrayByIndex(0));break;case f.Point:break;case f.CovariantVector:e.polyDataType.pointPixelComponents===3&&i.setVectors(i.getArrayByIndex(0));break;case f.SymmetricSecondRankTensor:e.polyDataType.pointPixelComponents===6&&i.setTensors(i.getArrayByIndex(0));break;case f.DiffusionTensor3D:e.polyDataType.pointPixelComponents===6&&i.setTensors(i.getArrayByIndex(0));break;case f.Complex:break;case f.FixedArray:break;case f.Array:break;case f.Matrix:break;case f.VariableLengthVector:break;case f.VariableSizeMatrix:break;default:return ne("Cannot handle unexpected itk-wasm pixel type ".concat(e.polyDataType.pointPixelType)),null}return o}function Ft(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n={polyDataType:{pointPixelComponentType:"float32",pointPixelComponents:1,pointPixelType:"Scalar",cellPixelComponentType:"float32",cellPixelComponents:1,cellPixelType:"Scalar"},numberOfPoints:e.getNumberOfPoints(),points:e.getPoints().getData(),verticesBufferSize:e.getVerts().getNumberOfValues(),vertices:e.getVerts().getData(),linesBufferSize:e.getLines().getNumberOfValues(),lines:e.getLines().getData(),polygonsBufferSize:e.getPolys().getNumberOfValues(),polygons:e.getPolys().getData(),triangleStripsBufferSize:e.getStrips().getNumberOfValues(),triangleStrips:e.getStrips().getData(),numberOfPointPixels:0,pointData:new Float32Array,numberOfCellPixels:0,cellData:new Float32Array},r=e.getPointData();if(r.getNumberOfArrays()){var s=t.pointDataName?r.getArrayByName(t.pointDataName):r.getArrayByIndex(0);n.numberOfPointPixels=s.getNumberOfTuples(),n.pointData=s.getData(),n.polyDataType.pointPixelComponentType=re.get(s.getDataType()),n.polyDataType.cellPixelComponentType=n.polyDataType.pointPixelComponentType,n.polyDataType.pointPixelComponents=s.getNumberOfComponents(),n.polyDataType.cellPixelComponents=n.polyDataType.pointPixelComponents,r.getTensors()===s?n.polyDataType.pointPixelType=f.SymmetricSecondRankTensor:r.getVectors()===s&&(n.polyDataType.pointPixelType=f.Vector),n.polyDataType.cellPixelType=n.polyDataType.pointPixelType}var o=e.getCellData();if(o.getNumberOfArrays()){var a=t.cellDataName?r.getArrayByName(t.cellDataName):r.getArrayByIndex(0);n.numberOfCellPixels=a.getNumberOfTuples(),n.cellData=a.getData(),n.polyDataType.cellPixelComponentType=re.get(a.getDataType()),n.polyDataType.cellPixelComponents=a.getNumberOfComponents(),o.getTensors()===a?n.polyDataType.cellPixelType=f.SymmetricSecondRankTensor:o.getVectors()===a?n.polyDataType.cellPixelType=f.Vector:n.polyDataType.cellPixelType=f.Scalar}return n}var zt={convertItkToVtkImage:Mt,convertVtkToItkImage:Ot,convertItkToVtkPolyData:Bt,convertVtkToItkPolyData:Ft};function Z(e){const t=d.exports.useContext(ie.ViewContext),n=r=>{const s=Number(r.currentTarget.value);e.setValue(s),setTimeout(t.renderView,0)};return ae("label",{style:{position:"absolute",zIndex:100,left:"5px",top:"0px",...e.style},children:[e.label,T("input",{type:"range",min:"0",max:e.max,value:e.value,onChange:n,style:{position:"sticky",zIndex:100,left:"5px",top:"5px",...e.style}})]})}function Et(e){const t=d.exports.useContext(ie.ViewContext);function n(r){const s=r.currentTarget.value;e.setValue(s),setTimeout(t.renderView,0)}return T("select",{value:e.value,onChange:n,style:{position:"absolute",zIndex:100,left:"5px",top:"5px",...e.style},children:e.options.map(r=>T("option",{children:r},r))})}function At(e){const t=d.exports.useContext(ie.ViewContext);function n(r){const s=r.currentTarget.checked;e.setValue(s),setTimeout(t.renderView,0)}return ae("label",{style:{position:"absolute",zIndex:100,left:"5px",top:"55px",...e.style},children:[e.label,T("input",{type:"checkbox",checked:e.value,onChange:n,style:{position:"sticky",zIndex:100,left:"105px",...e.style}})]})}const O=async()=>{console.log("Loading itk module..."),O.setStatusText("Loading itk module..."),window.itk||await lt.loadScript("https://cdn.jsdelivr.net/npm/itk-wasm@1.0.0-b.8/dist/umd/itk-wasm.js"),console.log("Fetching/downloading the input file, please wait..."),O.setStatusText("Loading data, please wait...");const e=await Pe.fetchBinary("https://data.kitware.com/api/v1/item/63c1c7f96d3fc641a02d7f27/download");console.log("Fetching/downloading input file done!"),O.setStatusText("Download complete!");const t=new Uint8Array(e),n=bt(t),r=[];Object.keys(n).forEach(i=>{i.endsWith(".dcm")&&r.push(i)});const s=[];window.itk&&await Promise.all(r.map(async(i,l)=>{const{image:c,webWorker:u}=await window.itk.readImageArrayBuffer(null,n[i].buffer,i);u.terminate();const v=zt.convertItkToVtkImage(c);s[l]=v}));const o=Qe.newInstance();for(const i of s)o.addItem(i);const a=s.reduce((i,l)=>l.getDimensions()[2]+i,0);return O.setMaxSlicingValue(a-1),O.setStatusText(""),o};function Rt(e){const[t,n]=d.exports.useState("Loading data, please wait ..."),[r,s]=d.exports.useState(47),[o,a]=d.exports.useState(2095),[i,l]=d.exports.useState(1e3),[c,u]=d.exports.useState("Grayscale"),[v,g]=d.exports.useState(!1),[h]=d.exports.useState(()=>ot.newInstance()),[b,F]=d.exports.useState(54);return O.setMaxSlicingValue=F,O.setStatusText=n,d.exports.useEffect(()=>{var E,A;const m=h.getImage(r),y=(A=(E=m==null?void 0:m.getPointData())==null?void 0:E.getScalars())==null?void 0:A.getRange();if(y&&y.length==2){const G=y[1]-y[0];a(G);const _=Math.round((y[0]+y[1])/2);l(_)}},[r]),T("div",{style:{width:"100%",height:"100%"},children:ae(_e,{id:"0",cameraPosition:[0,0,-1],cameraViewUp:[0,-1,0],cameraParallelProjection:!1,background:[65/255,86/255,122/255],children:[T(Te,{name:"mixedImages",children:T($e,{fetchData:O})}),T("label",{style:{position:"absolute",zIndex:100,left:"5px",top:"120px",fontSize:"50px"},children:t}),T(Z,{label:"kSlice",max:b,value:r,setValue:s,style:{top:"30px",left:"5px"}}),T(Z,{label:"colorLevel",max:4095,value:i,setValue:l,style:{top:"60px",left:"5px"}}),T(Z,{label:"colorWindow",max:4095,value:o,setValue:a,style:{top:"30px",left:"505px"}}),T(Et,{options:Ke.rgbPresetNames,value:c,setValue:u,style:{top:"60px",left:"505px"}}),T(At,{label:"useLookupTableScalarRange",value:v,setValue:g,style:{top:"90px",left:"5px"}}),T(He,{mapperInstance:h,kSlice:r,property:{colorWindow:o,colorLevel:i,useLookupTableScalarRange:v},colorMapPreset:c,children:T(Te,{name:"mixedImages"})})]})})}export{Rt as default};
